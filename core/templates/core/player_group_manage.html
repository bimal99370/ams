<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Manage Groups</title>-->
<!--    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">-->
<!--    <style>-->
<!--        .player-card {-->
<!--            display: inline-block;-->
<!--            width: 50px;-->
<!--            height: 50px;-->
<!--            margin: 1%;-->
<!--            text-align: center;-->
<!--            border-radius: 50%;-->
<!--            overflow: hidden;-->
<!--            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);-->
<!--            position: relative;-->
<!--        }-->
<!--        .player-card img {-->
<!--            width: 100%;-->
<!--            height: 100%;-->
<!--            object-fit: cover;-->
<!--        }-->
<!--        .player-card-container {-->
<!--            display: inline-block;-->
<!--            text-align: center;-->
<!--            margin: 1%;-->
<!--        }-->
<!--        .player-card-container p {-->
<!--            margin-top: 10px;-->
<!--            font-size: 14px;-->
<!--            color: #333;-->
<!--        }-->
<!--        .remove-player {-->
<!--            position: absolute;-->
<!--            top: 5px;-->
<!--            right: 5px;-->
<!--            background-color: red;-->
<!--            color: white;-->
<!--            border: none;-->
<!--            border-radius: 50%;-->
<!--            width: 20px;-->
<!--            height: 20px;-->
<!--            font-size: 14px;-->
<!--            line-height: 18px;-->
<!--            text-align: center;-->
<!--            cursor: pointer;-->
<!--        }-->
<!--        .list-group-item.selected {-->
<!--            background-color: #007bff;-->
<!--            color: #fff;-->
<!--        }-->
<!--        .add-group-btn {-->
<!--            margin-top: 10px;-->
<!--        }-->
<!--        .player-select-container {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            justify-content: space-between;-->
<!--            padding: 5px;-->
<!--            border: 1px solid #ddd;-->
<!--            margin-bottom: 5px;-->
<!--            border-radius: 5px;-->
<!--            cursor: pointer;-->
<!--        }-->
<!--        .player-select-container.selected {-->
<!--            background-color: #d4edda;-->
<!--            border-color: #c3e6cb;-->
<!--        }-->
<!--        .player-select-container input {-->
<!--            display: none;-->
<!--        }-->
<!--        .player-select-container label {-->
<!--            cursor: pointer;-->
<!--            flex-grow: 1;-->
<!--        }-->
<!--        .checkmark {-->
<!--            display: none;-->
<!--            color: green;-->
<!--            font-weight: bold;-->
<!--        }-->
<!--        .player-select-container.selected .checkmark {-->
<!--            display: block;-->
<!--        }-->
<!--        .player-select-list {-->
<!--            display: flex;-->
<!--            flex-wrap: wrap;-->
<!--        }-->
<!--        .player-select-list .player-select-container {-->
<!--            width: 48%;-->
<!--            margin-right: 2%;-->
<!--        }-->
<!--        .player-select-list .player-select-container:nth-child(2n) {-->
<!--            margin-right: 0;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<div class="container mt-5">-->
<!--    <h1 class="mb-4 text-center">Manage Groups</h1>-->

<!--    <div class="row">-->
<!--        &lt;!&ndash; Left Side: List of Groups &ndash;&gt;-->
<!--        <div class="col-md-4">-->
<!--            <h3>Groups</h3>-->
<!--            <ul class="list-group" id="groupList">-->
<!--                {% for group in groups %}-->
<!--                <li class="list-group-item" onclick="showGroupPlayers('{{ group.pk }}', this)">-->
<!--                    {{ group.name }}-->
<!--                </li>-->
<!--                {% endfor %}-->
<!--            </ul>-->
<!--            <button class="btn btn-primary add-group-btn" data-toggle="modal" data-target="#createGroupModal">Create Group</button>-->
<!--        </div>-->

<!--        &lt;!&ndash; Right Side: Players in Selected Group &ndash;&gt;-->
<!--        <div class="col-md-8">-->
<!--            <div id="groupDetails" style="display: none;">-->
<!--                <h3>Players</h3>-->
<!--                <div id="playersList" class="d-flex flex-wrap"></div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Create Group Modal &ndash;&gt;-->
<!--<div class="modal fade" id="createGroupModal" tabindex="-1" role="dialog" aria-labelledby="createGroupModalLabel" aria-hidden="true">-->
<!--    <div class="modal-dialog" role="document">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <h5 class="modal-title" id="createGroupModalLabel">Create Group</h5>-->
<!--                <button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
<!--                    <span aria-hidden="true">&times;</span>-->
<!--                </button>-->
<!--            </div>-->
<!--            <form method="post" id="createGroupForm" action="{% url 'manage_groups' %}">-->
<!--                {% csrf_token %}-->
<!--                <div class="modal-body">-->
<!--                    <div class="form-group">-->
<!--                        <label for="groupName">Group Name</label>-->
<!--                        <input type="text" class="form-control" id="groupName" name="name" required>-->
<!--                    </div>-->
<!--                    <div class="form-group">-->
<!--                        <label for="groupPlayers">Select Players</label>-->
<!--                        <div id="groupPlayers" class="player-select-list">-->
<!--                            {% for player in players %}-->
<!--                            <div class="player-select-container" id="player-{{ player.pk }}">-->
<!--                                <input type="checkbox" id="player_{{ player.pk }}" name="group_players" value="{{ player.pk }}">-->
<!--                                <label for="player_{{ player.pk }}">{{ player.name }}</label>-->
<!--                                <span class="checkmark">✔</span>-->
<!--                            </div>-->
<!--                            {% endfor %}-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer">-->
<!--                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>-->
<!--                    <button type="submit" name="create_group" class="btn btn-primary">Create Group</button>-->
<!--                </div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>-->
<!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>-->
<!--<script>-->
<!--    function showGroupPlayers(groupId, element) {-->
<!--        $('#playersList').empty();-->
<!--        $('#groupList .list-group-item').removeClass('selected');-->
<!--        $(element).addClass('selected');-->

<!--        $.ajax({-->
<!--            url: "{% url 'get_group_players' %}",-->
<!--            data: {-->
<!--                'group_id': groupId-->
<!--            },-->
<!--            success: function (data) {-->
<!--                var players = data.players;-->
<!--                players.forEach(function (player) {-->
<!--                    var playerCard = '<div class="player-card-container"><div class="player-card"><img src="' + player.image + '" alt="' + player.name + '"></div><p>' + player.name + '</p></div>';-->
<!--                    $('#playersList').append(playerCard);-->
<!--                });-->
<!--                $('#groupDetails').show();-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    $(document).ready(function () {-->
<!--        $('.player-select-container').click(function () {-->
<!--            $(this).toggleClass('selected');-->
<!--            var checkbox = $(this).find('input[type="checkbox"]');-->
<!--            checkbox.prop('checked', !checkbox.prop('checked'));-->
<!--        });-->

<!--        $('#createGroupForm').submit(function () {-->
<!--            var selectedPlayers = $('.player-select-container.selected').map(function () {-->
<!--                return $(this).find('input').val();-->
<!--            }).get();-->
<!--            $('input[name="group_players"]').val(selectedPlayers);-->
<!--        });-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!--&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
<!--&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
<!--&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Groups</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <style>
        .player-card {
            display: inline-block;
            width: 50px;
            height: 50px;
            margin: 1%;
            text-align: center;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        .player-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .player-card-container {
            display: inline-block;
            text-align: center;
            margin: 1%;
        }
        .player-card-container p {
            margin-top: 10px;
            font-size: 14px;
            color: #333;
        }
        .remove-player {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: red;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 14px;
            line-height: 18px;
            text-align: center;
            cursor: pointer;
        }
        .list-group-item.selected {
            background-color: #007bff;
            color: #fff;
        }
        .add-group-btn {
            margin-top: 10px;
        }
        .player-select-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 5px;
            border: 1px solid #ddd;
            margin-bottom: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .player-select-container.selected {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        .player-select-container input {
            display: none;
        }
        .player-select-container label {
            cursor: pointer;
            flex-grow: 1;
        }
        .checkmark {
            display: none;
            color: green;
            font-weight: bold;
        }
        .player-select-container.selected .checkmark {
            display: block;
        }
        .player-select-list {
            display: flex;
            flex-wrap: wrap;
        }
        .player-select-list .player-select-container {
            width: 48%;
            margin-right: 2%;
        }
        .player-select-list .player-select-container:nth-child(2n) {
            margin-right: 0;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h1 class="mb-4 text-center">Manage Groups</h1>

    <div class="row">
        <!-- Left Side: List of Groups -->
        <div class="col-md-4">
            <h3>Groups</h3>
            <ul class="list-group" id="groupList">
                {% for group in groups %}
                <li class="list-group-item" onclick="showGroupPlayers('{{ group.pk }}', this)">
                    {{ group.name }}
                    <form method="post" action="{% url 'delete_group' group.pk %}" style="display: inline;">
                        {% csrf_token %}
                        <input type="hidden" name="group_id" value="{{ group.pk }}">
                        <button type="submit" class="btn btn-danger btn-sm float-right ml-2">Delete</button>
                    </form>
                </li>
                {% endfor %}
            </ul>
            <button class="btn btn-primary add-group-btn" data-toggle="modal" data-target="#createGroupModal">Create Group</button>
        </div>

        <!-- Right Side: Players in Selected Group -->
        <div class="col-md-8">
            <div id="groupDetails" style="display: none;">
                <h3>Players</h3>
                <div id="playersList" class="d-flex flex-wrap"></div>
            </div>
        </div>
    </div>
</div>

<!-- Create Group Modal -->
<div class="modal fade" id="createGroupModal" tabindex="-1" role="dialog" aria-labelledby="createGroupModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="createGroupModalLabel">Create Group</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="post" id="createGroupForm" action="{% url 'manage_groups' %}">
                {% csrf_token %}
                <div class="modal-body">
                    <div class="form-group">
                        <label for="groupName">Group Name</label>
                        <input type="text" class="form-control" id="groupName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="groupPlayers">Select Players</label>
                        <div id="groupPlayers" class="player-select-list">
                            {% for player in players %}
                            <div class="player-select-container" id="player-{{ player.pk }}" onclick="togglePlayerSelection({{ player.pk }})">
                                <input type="checkbox" id="player_{{ player.pk }}" name="group_players" value="{{ player.pk }}">
                                <label for="player_{{ player.pk }}">{{ player.name }}</label>
                                <span class="checkmark">✔</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" name="create_group" class="btn btn-primary">Create Group</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script>
    function showGroupPlayers(groupId, element) {
        $('#playersList').empty();
        $('#groupList .list-group-item').removeClass('selected');
        $(element).addClass('selected');

        $.ajax({
            url: "{% url 'get_group_players' %}",
            data: {
                'group_id': groupId
            },
            success: function(data) {
                data.players.forEach(function(player) {
                    var firstName = player.name.split(' ')[0];
                    var playerCard = `
                        <div class="player-card-container">
                            <div class="player-card">
                                <img src="${player.image}" alt="${player.name}">
                                <button class="remove-player" onclick="removePlayerFromGroup(${groupId}, ${player.pk})">×</button>
                            </div>
                            <p>${firstName}</p>
                        </div>`;
                    $('#playersList').append(playerCard);
                });
                $('#groupDetails').show();
            }
        });
    }

    function togglePlayerSelection(playerId) {
        var playerContainer = $('#player-' + playerId);
        var checkbox = playerContainer.find('input[type="checkbox"]');
        var checkmark = playerContainer.find('.checkmark');

        if (checkbox.is(':checked')) {
            checkbox.prop('checked', false);
            playerContainer.removeClass('selected');
            checkmark.hide();
        } else {
            checkbox.prop('checked', true);
            playerContainer.addClass('selected');
            checkmark.show();
        }
    }

    function removePlayerFromGroup(groupId, playerId) {
        $.post("{% url 'manage_groups' %}", {
            'group_id': groupId,
            'player_id': playerId,
            'remove_player_from_group': true,
            'csrfmiddlewaretoken': '{{ csrf_token }}'
        }, function() {
            showGroupPlayers(groupId, $('#groupList .list-group-item.selected')[0]);
        });
    }
</script>
</body>
</html>
